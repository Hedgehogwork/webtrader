{"version":3,"sources":["../../../../src/trade/tradeConf.es6"],"names":["display_decimals","binders","priority","bind","el","model","chart","Highcharts","Chart","title","credits","enabled","type","renderTo","backgroundColor","width","getAttribute","height","marginLeft","tooltip","formatter","tick","array","x","xAxis","min","max","labels","yAxis","align","addComma","value","toFixed","gridLineWidth","series","data","marker","plotOptions","scatter","enableMouseTracking","exporting","enableImages","legend","routine","ticks","tick_idx","length","barrier","make_barrier","contract_is_finished","draw_barrier","draw_exit_spot","draw_tick","draw_entry_spot","is_path_dependent_contract","is_path_dependent","exit_tick_idx","findIndex","epoch","sell_spot_time","exit_tick_time","exit_spot","make_exit_spot","draw_x_line","addPoint","quote","is_label_left","entry_spot","make_entry_spot","removePlotLine","id","draw_y_line","options","align_label_left","label_x_position","addPlotLine","label","text","color","dashStyle","register_ticks","state","extra","proposal_open_contract","on_proposal_open_contract","on_tick","tick_count","add_tick","is_or_after_contract_entry","entry_tick_time","is_new_tick","some","state_tick","should_add_new_tick","status","buy","on_contract_finished","update_chart","add_tick_to_state","decimal_digits","digits_after_decimal","pip","symbol","make_tooltip","push","number","tick_time","utc","format","symbol_name","tick_quote_formatted","tick_arr_copy","slice","forget_stream_and_cb","update","back","visible","contract_id","events","off","forget","on","is_different_open_contract_stream","error","on_open_proposal_error","temp_ticks","is_different_stream","waiting_for_contract_entry_tick","forEach","stored_tick","growl","message","echo_req","subscribe","init","show_callback","hide_callback","root","i18n","longcode","balance_after","buy_price","currencyFractionalDigits","purchase_time","start_time","transaction_id","payout","currency","potential_profit","potential_profit_text","show_result","spreads","amount_per_point","stop_loss_level","stop_profit_level","inx","digits_value","category","category_display","chart_visible","show_tick_chart","arrow","contract_category","isLookback","contract_type","formula","amount","undefined","waiting","won","lost","sell_expired","onclick","e","$target","target","hasClass","addClass","require","viewTransaction","then","removeClass","view"],"mappings":"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","file":"tradeConf.js","sourcesContent":["﻿import $ from 'jquery';\nimport moment from 'moment';\nimport liveapi from '../websockets/binary_websockets';\nimport rv from '../common/rivetsExtra';\nimport chartingRequestMap from '../charts/chartingRequestMap';\nimport html from 'text!../trade/tradeConf.html';\nimport 'css!../trade/tradeConf.css';\nimport Lookback from './lookback';\nimport '../common/util';\n\n/* rv binder to show tick chart for this confirmation dialog */\nlet display_decimals;\nrv.binders['tick-chart'] = {\n   priority: 65, /* a low priority to apply last */\n   bind: function(el) {\n      const model = this.model;\n      el.chart = new Highcharts.Chart({\n         title: '',\n         credits: {enabled: false},\n         chart: {\n            type: 'line',\n            renderTo: el,\n            backgroundColor: null, /* make background transparent */\n            width: (el.getAttribute('width') || 400)*1,\n            height: (el.getAttribute('height') || 120)*1,\n            marginLeft: 20,\n         },\n         tooltip: {\n            formatter: function () {\n               const tick = model.array[this.x-1];\n               return (tick && tick.tooltip) || false;\n            }\n         },\n         xAxis: {\n            type: 'linear',\n            min: 1,\n            max: el.getAttribute('tick-count')*1 + 1 /* exist spot vertical plot will not be at the end */,\n            labels: { enabled: false, }\n         },\n         yAxis: {\n            labels: {\n                  align: 'left',\n                  x: 0,\n                  formatter() {\n                        return addComma(this.value.toFixed(display_decimals));\n                  },\n            },\n            title: '',\n            gridLineWidth: 0,\n         },\n         series: [\n            { data: [] },\n            /* HighChart scales the y-axis automatically based on the maximum value of data.\n             * but it doesn't consider the plotLine's value in its calculations.\n             * We add an invisible seri and late plotline values to work around this issue. */\n            {\n               type: 'scatter',\n               marker: { enabled: false },\n               data: []\n            }\n         ],\n         plotOptions: { scatter: { enableMouseTracking: false } },\n         exporting: {enabled: false, enableImages: false},\n         legend: {enabled: false},\n      });\n   },\n   routine: function(el, ticks){\n      // Handles updating chart: state.ticks.array updates => routine fires\n      const model = this.model;\n      const tick_idx = ticks.length;\n      const barrier = model.make_barrier();\n      const { contract_is_finished } = model;\n\n      if (barrier) {\n            draw_barrier(barrier);\n      }\n\n      if (contract_is_finished) {\n            draw_exit_spot(model, ticks);\n            return;\n      }\n\n      if (tick_idx === 0) return;\n\n      draw_tick(tick_idx);\n\n      if (tick_idx === 1) {\n            draw_entry_spot(tick_idx);\n      }\n\n      function draw_exit_spot(model, ticks) {\n            const is_path_dependent_contract = !!model.is_path_dependent;\n            let exit_tick_idx = ticks.findIndex((tick) => {\n                  if (is_path_dependent_contract) {\n                        return tick.epoch === (+model.sell_spot_time);\n                  }\n                  return tick.epoch === (+model.exit_tick_time);\n            });\n            const exit_spot = model.make_exit_spot(exit_tick_idx + 1);\n            draw_x_line(el.chart, exit_spot);\n      };\n\n      function draw_tick(tick_idx) {\n            const tick = ticks[tick_idx -1];\n            el.chart.series[0].addPoint([tick_idx, tick.quote]);\n      };\n\n      function draw_entry_spot(tick_idx) {\n            const is_label_left = true;\n            const entry_spot = model.make_entry_spot(tick_idx);\n            draw_x_line(el.chart, entry_spot, is_label_left);\n      };\n\n      function draw_barrier(barrier) {\n            el.chart.yAxis[0].removePlotLine(barrier.id);\n            draw_y_line(el.chart, barrier);\n      };\n\n      function draw_x_line(chart, options, align_label_left) {\n            const label_x_position = align_label_left ? -15 : 5;\n   \n            chart.xAxis[0].addPlotLine({\n               value: options.value,\n               id: options.id || options.value,\n               label: {text: options.label || 'label', x:  label_x_position },\n               color: options.color || '#e98024',\n               width: options.width || 2,\n               dashStyle: options.dashStyle || false,\n            });\n      };\n\n      function draw_y_line(chart,options) {\n            chart.yAxis[0].addPlotLine({\n               id: options.id || options.label,\n               value: options.value,\n               label: {text: options.label, align: 'center'},\n               color: 'green',\n               width: 2,\n            });\n            /* Add plotline value to invisible seri to make the plotline always visible. */\n            chart.series[1].addPoint([1, options.value*1]);\n      };\n   }\n};\n\nconst register_ticks = (state, extra) => {\n   let proposal_open_contract;\n   let on_proposal_open_contract;\n   let on_tick;\n   let { tick_count } = extra;\n   /* No need to worry about WS connection getting closed, because the user will be logged out */\n   const add_tick  = (tick) => {\n      const is_or_after_contract_entry = (+tick.epoch) >= (+proposal_open_contract.entry_tick_time);\n      const is_new_tick = !state.ticks.array.some((state_tick) => state_tick.epoch * 1 === tick.epoch * 1);\n      const should_add_new_tick = is_new_tick && !state.ticks.contract_is_finished && is_or_after_contract_entry;\n\n      if (should_add_new_tick) {\n            const contract_is_finished = proposal_open_contract.status !== 'open' && !state.ticks.contract_is_finished;\n            state.buy.barrier = proposal_open_contract.barrier ? (+proposal_open_contract.barrier) : null;\n\n            if (contract_is_finished) {\n                  on_contract_finished(proposal_open_contract);\n                  update_chart();\n            }\n            tick_count--;\n            if (tick_count > -1) {\n                  add_tick_to_state(tick);\n            }\n      }\n   }\n\n   function add_tick_to_state(tick) {\n      const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, extra.symbol);\n      const tooltip = make_tooltip(tick);\n\n      state.ticks.array.push({\n         quote: (+tick.quote),\n         epoch: (+tick.epoch),\n         number: state.ticks.array.length + 1,\n         tooltip,\n         decimal_digits,\n      });\n\n      function make_tooltip(tick) {\n            const tick_time = moment.utc(tick.epoch*1000).format('dddd, MMM D, HH:mm:ss');\n            const { symbol_name } = extra;\n            const tick_quote_formatted = (+tick.quote).toFixed(decimal_digits);\n\n            return `${tick_time}<br/>${symbol_name} ${(+tick.quote).toFixed(decimal_digits)}`;\n      };\n   };\n\n   function update_chart() {\n            const tick_arr_copy = state.ticks.array.slice();\n            state.ticks.array = [...tick_arr_copy];\n    }\n\n   const on_contract_finished = (proposal_open_contract) => {\n      forget_stream_and_cb();\n\n      state.ticks.contract_is_finished = true;\n      state.ticks.is_path_dependent = proposal_open_contract.is_path_dependent ? proposal_open_contract.is_path_dependent : null;\n      state.ticks.exit_tick_time = proposal_open_contract.exit_tick_time ? proposal_open_contract.exit_tick_time : null;\n      state.ticks.sell_spot_time = proposal_open_contract.sell_spot_time ? proposal_open_contract.sell_spot_time : null;\n      state.ticks.status = proposal_open_contract.status;\n\n      state.buy.update();\n      state.back.visible = true;\n\n      function forget_stream_and_cb() {\n            const { contract_id } = extra;\n            liveapi.events.off('proposal_open_contract', on_proposal_open_contract);\n            liveapi.events.off('tick', on_tick);\n            liveapi.proposal_open_contract.forget(contract_id);\n      };\n   };\n\n   on_proposal_open_contract = liveapi.events.on('proposal_open_contract', (data) => {\n            const is_different_open_contract_stream = data.proposal_open_contract.contract_id !== extra.contract_id;\n            if (is_different_open_contract_stream) return;\n\n            if (data.error) {\n                  on_open_proposal_error(data);\n                  return;\n            }\n\n            ({ proposal_open_contract } = data);\n   });\n   \n  let temp_ticks = [];\n  on_tick = liveapi.events.on('tick', (data) => {\n      const is_different_stream = extra.symbol !== data.tick.symbol;\n      if (is_different_stream) return;\n\n      const waiting_for_contract_entry_tick = !proposal_open_contract || !proposal_open_contract.entry_tick_time;\n      if (waiting_for_contract_entry_tick) {\n            temp_ticks.push(data.tick);\n            return;\n      }\n\n      if (temp_ticks.length > 0) {\n            temp_ticks.forEach((stored_tick) => add_tick(stored_tick));\n            temp_ticks = [];\n      }\n\n      add_tick(data.tick);\n    });\n\n   const on_open_proposal_error = (data) => {\n      $.growl.error({message: data.error.message});\n      liveapi.proposal_open_contract.forget(data.echo_req.contract_id);\n      liveapi.proposal_open_contract.subscribe(data.echo_req.contract_id);\n   };\n}\n\nexport const init = (data, extra, show_callback, hide_callback) => {\n   display_decimals = data.display_decimals || 3;\n   const root = $(html).i18n();\n   const { buy } = data;\n   const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, extra.symbol);\n   const state = {\n      title: {\n         text: 'Contract Confirmation'.i18n(),\n      },\n      buy: {\n         barrier: null,\n         message: buy.longcode,\n         balance_after: buy.balance_after,\n         buy_price: (+buy.buy_price).toFixed(currencyFractionalDigits()),\n         purchase_time: buy.purchase_time,\n         start_time: buy.start_time,\n         transaction_id: buy.transaction_id,\n         payout: (+buy.payout).toFixed(currencyFractionalDigits()),\n         currency: extra.currency,\n         potential_profit : (buy.payout - buy.buy_price).toFixed(currencyFractionalDigits()),\n         potential_profit_text : 'Profit'.i18n(),\n         show_result: false,\n      },\n      spreads: {\n         amount_per_point: buy.amount_per_point || '0',\n         stop_loss_level: buy.stop_loss_level || '0',\n         stop_profit_level: buy.stop_profit_level || '0',\n      },\n      ticks: {\n         array: [],\n         contract_is_finished: false,\n         exit_tick_time: null,\n         sell_spot_time: null,\n         is_path_dependent: null,\n         make_exit_spot: (inx) => ({value: inx, label: 'Exit Spot'.i18n(), dashStyle: 'Dash'}),\n         make_entry_spot: (inx) => ({value: inx, label: 'Entry Spot'.i18n()}),\n         make_barrier: () => {\n            const { barrier } = state.buy;\n            if (barrier) {\n                  return { value: +barrier, label: 'Barrier ('.i18n() + addComma(barrier.toFixed(decimal_digits)) + ')', id: 'plot-barrier-y'};\n            }\n            return null;\n         },\n         tick_count: extra.tick_count,\n         value: (extra.digits_value || '0') + '', // last digit value selected by the user\n         category: extra.category,\n         category_display: extra.category_display,\n\n         status: 'waiting', /* could be 'waiting', 'lost' or 'won' */\n         chart_visible: extra.show_tick_chart,\n      },\n      arrow: {\n         visible: !extra.show_tick_chart && extra.category.contract_category !== 'digits',\n      },\n      back: { visible: false }, /* back buttom */\n   };\n\n   if (Lookback.isLookback(extra.category_display.contract_type)) {\n     state.buy.payout = Lookback.formula(extra.category_display.contract_type, extra.amount);\n     state.buy.potential_profit = undefined;\n   }\n\n   state.buy.update = () => {\n      const { status } = state.ticks;\n      state.title.text = { waiting: 'Contract Confirmation'.i18n(),\n         won : 'This contract won'.i18n(),\n         lost: 'This contract lost'.i18n()\n      }[status];\n      if(status === 'lost') {\n         state.buy.potential_profit = (-state.buy.buy_price).toFixed(currencyFractionalDigits());\n         state.buy.payout = (0).toFixed(currencyFractionalDigits());\n         state.buy.potential_profit_text = 'Lost';\n      }\n      if(status === 'won') {\n         state.buy.balance_after = buy.balance_after*1 + state.buy.payout*1;\n         liveapi.sell_expired(); // to update balance immediately\n      }\n      state.buy.show_result = true;\n   }\n\n   state.back.onclick = () => hide_callback(root);\n   state.arrow.onclick = (e) => {\n      const $target = $(e.target);\n      if(!$target.hasClass('disabled')) {\n         $target.addClass('disabled');\n         require(['viewtransaction/viewTransaction'], (viewTransaction) => {\n            viewTransaction.init(extra.contract_id, extra.transaction_id)\n               .then(() => $target.removeClass('disabled'));\n         });\n      }\n   };\n\n   const view = rv.bind(root[0], state)\n\n   if(!state.arrow.visible) { register_ticks(state, extra); }\n   else { state.back.visible = true; }\n\n   show_callback(root);\n}\n\nexport default  { init }\n"]}